import os

os.environ["TF_ENABLE_ONEDNN_OPTS"] = "0"  # suppress tf warning

from stnd.utility.utils import (
    # Constants
    MAX_BUFFER_SIZE,
    SYSTEM_PLATFORM,
    DEFAULT_HASH_SIZE,
    DEFAULT_EXPERIMENTS_FOLDER,
    PROFILER_GROUP_BY_STACK_N,
    PROFILER_OUTPUT_ROW_LIMIT,
    DEFAULT_FILE_CHUNK_SIZE,
    EMPTY_CSV_TOKEN,
    DEFAULT_ENV_NAME,
    TEST_ENV_NAME,
    BASHRC_PATH,
    NEW_SHELL_INIT_COMMAND,
    FLOATING_POINT,
    NAME_SEP,
    NAME_NUMBER_SEPARATOR,
    NULL_CONTEXT,
    PROJECT_ROOT_ENV_NAME,
    DEFAULT_SLEEP_TIME,
    DEFAULT_NUM_ATTEMTPS,
    MAX_RETRIES_ERROR_MSG,
    DEFAULT_INDENT_IN_JSON,
    LIST_START_SYMBOL,
    LIST_END_SYMBOL,
    DELIMETER,
    QUOTE_CHAR,
    ESCAPE_CHAR,
    INF,
    TOL,
    EXPONENTIAL_SYMBOLS,
    PLT_ROW_SIZE,
    PLT_COL_SIZE,
    PLT_PLOT_HEIGHT,
    PLT_PLOT_WIDTH,
    ENV_VAR_RE,
    # Classes
    ChildrenForPicklingPreparer,
    SetEncoder,
    AttrDict,
    # Functions
    object_attributes,
    read_yaml,
    apply_random_seed,
    get_current_time,
    raise_unknown,
    append_dict,
    check_element_in_iterable,
    check_dict,
    run_cmd_through_popen,
    runcmd,
    get_project_root_path,
    get_stuned_root_path,
    make_unique_run_name,
    get_current_run_folder,
    get_hash,
    get_value_from_config,
    log_or_print,
    error_or_print,
    prepare_for_pickling,
    prepare_for_unpickling,
    make_checkpoint_name,
    get_leaves_of_nested_dict,
    update_dict_by_nested_key,
    apply_func_to_dict_by_nested_key,
    extract_profiler_results,
    check_equal_shape,
    move_folder_contents,
    remove_all_but_subdirs,
    remove_file_or_folder,
    is_nested_dict,
    ensure_separator_after_folder,
    compute_file_hash,
    get_hasher,
    get_hostname,
    remove_filename_extension,
    range_for_each_group,
    coefficients_for_bases,
    error_callback,
    deterministic_subset,
    compute_proportion,
    make_autogenerated_config_name,
    save_as_yaml,
    write_into_csv_pd,
    write_into_csv_with_column_names,
    count_rows_in_file,
    remove_elements_from_the_end,
    itself_and_lower_upper_case,
    decode_strings_in_dict,
    decode_val_from_str,
    replace_many_by_one,
    str_is_number,
    parse_float_or_int_from_string,
    escape_all_chars_in_string,
    parse_list_from_string,
    read_csv_as_dict,
    read_csv_as_dict_pd,
    normalize_string_path,
    normalize_path,
    read_json,
    dicts_with_non_intersecting_keys,
    is_number,
    bootstrap_by_key_subname,
    find_by_subkey,
    get_system_root_path,
    prepare_factory_without_args,
    raise_func,
    retrier_factory,
    pretty_json,
    touch_file,
    kill_processes,
    make_file_lock,
    check_duplicates,
    has_nested_attr,
    get_nested_attr,
    set_nested_attr,
    write_csv_dict_to_csv,
    write_csv_dict_to_csv_pd,
    expand_csv,
    instantiate_from_config,
    as_str_for_csv,
    check_consistency,
    func_for_dim,
    parse_name_and_number,
    prune_list,
    get_with_assert,
    properties_diff,
    get_even_from_wrapped,
    add_custom_properties,
    invert_dict,
    load_from_pickle,
    extract_list_from_huge_string,
    apply_pairwise,
    extract_tar_to_folder,
    create_tar_from_folder,
    get_filename_from_url,
)
from ._utils import (
    TimeStampEventHandler,
    compute_dicts_diff,
    randomly_subsample_indices_uniformly,
    deterministically_subsample_indices_uniformly,
    get_device,
    get_model_device,
    download_and_extract_tar,
    optionally_make_dir,
    download_file,
    show_images,
    imshow,
    get_cmap,
    compute_tensor_cumsums,
    compute_unique_tensor_value,
    aggregate_tensors_by_func,
    folder_still_has_updates,
    read_old_checkpoint,
    read_model_from_old_checkpoint,
    cat_or_assign,
    assert_two_values_are_close,
    read_checkpoint,
    save_checkpoint,
)
